# NIKKE 冠军竞技场助手

本项目是一个为游戏《NIKKE: 胜利女神》PC客户端设计的自动化辅助脚本，旨在帮助玩家在冠军竞技场（Champion Arena）等多种游戏模式中高效地进行截图、信息记录与复盘。

**下载地址:** [点此下载最新版本](https://github.com/entishl/nikke-CAranea-Helper/releases)

# 下面没啥好看的

## ✨ 主要功能

*   **多种操作模式**: 针对不同游戏场景和需求，提供精细化的操作模式。
    *   **模式 1 (应援预测)**: 截取并拼接对战双方的队伍信息，用于赛前预测。
    *   **模式 2 (应援复盘)**: 截取对战结果，并结合双方队伍信息进行拼接，用于赛后复盘。
    *   **模式 3 (应援预测 - 民意)**: 截取民意投票区域，并结合双方队伍信息进行拼接。
    *   **模式 4 (晋级赛当前小组总览)**: 针对“64进8”等晋级赛制，依次处理小组内所有玩家的队伍信息并截图，生成总览图。
    *   **模式 5 (冠军赛总览)**: 针对“冠军争霸赛”决赛圈，依次处理所有玩家的队伍信息并截图，生成总览图。
    *   **模式 6 (晋级赛赛果 - 共8组)**: 自动化处理冠军竞技场分组赛的完整阶段，依次点击8个分组，对每个分组内的所有比赛（8进4、4进2、2进1）进行截图和信息记录。
    *   **模式 7 (晋级赛当前小组赛果)**: 自动化处理冠军竞技场当前显示的分组赛，对当前屏幕所显示分组内的所有比赛进行截图和信息记录。
    *   **模式 8 (冠军赛赛果)**: 自动化处理冠军竞技场当前显示的冠军锦标赛对阵图。
    *   **模式 9 (图片标准化和打包)**: 将先前模式生成的PNG图片进行宽度调整、转换为WebP格式，并打包成ZIP文件。
*   **自动化操作**: 自动查找并激活游戏窗口，模拟鼠标点击，截取指定区域图像。
*   **图像处理**: 支持将多张截图垂直或水平拼接成一张大图，方便查看和分享。
*   **相对坐标定位**: 所有点击和截图操作均基于窗口的相对坐标（以3840x2160分辨率为基准计算），以适应不同分辨率下的游戏窗口。
*   **图形用户界面 (GUI)**: 提供友好的图形界面，方便用户选择模式、查看说明、控制脚本启停以及查看实时日志。

## 🛠️ 系统与软件要求

*   **操作系统**: Windows (脚本使用了 `win32gui` 等Windows特定API)。
*   **Python版本**: 建议 Python 3.7 或更高版本。
*   **Python依赖库**:
    *   `Pillow`
    *   `pyautogui`
    *   `pygetwindow`
    *   `psutil`
    *   `pywin32`
    *   `keyboard`
    *   `customtkinter`
*   **管理员权限**: 脚本需要以管理员权限运行，以便正确操作游戏窗口和模拟输入。GUI界面会显示当前是否具有管理员权限。
*   **游戏环境**:
    *   已安装并运行《NIKKE: 胜利女神》PC客户端。
    *   游戏窗口标题应为 "NIKKE"。

## 🚀 安装指南

1.  **安装 Python**:
    如果你的系统中没有安装Python，请从 [Python官网](https://www.python.org/downloads/) 下载并安装最新稳定版的Python。安装时请勾选 "Add Python to PATH"。

2.  **下载项目文件**:
    从本项目的 [Releases页面](https://github.com/entishl/nikke-CAranea-Helper/releases) 下载最新版本的压缩包，并解压到你的电脑上。确保包含所有 `.py` 文件和 `assets` 文件夹。

3.  **安装依赖库**:
    打开命令提示符 (cmd) 或 PowerShell，进入项目所在的文件夹，然后运行以下命令来安装所需的Python库：
    ```bash
    pip install Pillow pyautogui pygetwindow psutil pywin32 keyboard customtkinter
    ```
    或者，如果项目提供了 `requirements.txt` 文件 (未来可能添加)，可以使用：
    ```bash
    pip install -r requirements.txt
    ```

## ▶️ 如何运行

1.  **准备 `assets` 文件夹**:
    确保项目根目录下存在 `assets` 文件夹，并且其中包含名为 `1.png` 到 `9.png` 的图片文件。这些图片用于在GUI中展示对应模式的说明图。

2.  **以管理员身份运行**:
    找到 [`gui_app.py`](gui_app.py:1) 文件 (或旧版的 `main_gui.py` 如果尚未更新)，右键点击，选择“以管理员身份运行”。这是必需的，否则脚本可能无法正常工作。GUI界面会提示当前是否拥有管理员权限。

3.  **启动游戏**:
    确保《NIKKE: 胜利女神》PC客户端已经启动并进入游戏主界面或相应的竞技场界面。

4.  **使用图形界面**:
    *   **选择模式**: 在GUI左侧的“模式选择”区域，点击对应的按钮选择你想要运行的模式。右侧会显示该模式的说明图片（来自 `assets` 文件夹）。
    *   **查看提示**: GUI下方会显示操作提示，例如“提示: 先进入所选模式的对应界面再点击运行”。
    *   **启动脚本**: 点击右下角的“启动脚本”按钮。脚本会有5秒倒计时，倒计时期间你可以切换到NIKKE游戏窗口。
    *   **查看日志**: 脚本启动后，右侧区域会自动切换到日志视图，显示脚本的运行状态和信息。
    *   **停止脚本**:
        *   可以点击右下角的“停止脚本”按钮（脚本运行时可用）。
        *   也可以使用全局热键 `Ctrl + 1` 来强制停止脚本运行。

## 🖥️ 图形界面说明

*   **左侧边栏 (模式选择)**:
    *   按功能分类列出了所有可用的模式按钮。
    *   点击按钮即可选中对应模式，右侧会显示相应的说明图。
*   **右侧内容区**:
    *   **显示区域**:
        *   默认显示选中模式的说明图片（从 `assets` 目录加载，例如 [`assets/1.png`](assets/1.png) 对应模式1）。
        *   当脚本启动后，此区域会自动切换为日志文本框，实时显示脚本的运行日志。
    *   **控制区域**:
        *   **状态标签**: 显示操作提示和快捷键信息。
        *   **管理员状态标签**: 显示当前是否以管理员权限运行。
        *   **启动脚本按钮**: 点击后有5秒倒计时，然后执行选定模式的脚本。
        *   **停止脚本按钮**: 在脚本运行时变为可用，点击可发送停止信号给正在运行的脚本。

## ⚙️ 模式详解

*   **模式 1-3 (应援/预测/复盘)**:
    *   **操作对象**: 通常是两个玩家的对战界面。
    *   **输出**: 在 `final_output/` 目录下生成拼接后的 `combined_prediction.png`, `combined_review.png`, 或 `combined_anti_buy.png`。
*   **模式 4 (晋级赛当前小组总览)**:
    *   **操作对象**: 64进8等比赛的多个玩家界面。
    *   **输出**: 在 `final_output/` 目录下生成 `64in8_overview.png` 总览图。单个玩家的详细截图在生成总览图后会被清理。
*   **模式 5 (冠军赛总览)**:
    *   **操作对象**: 冠军争霸赛决赛圈的多个玩家界面。
    *   **输出**: 在 `final_output/` 目录下生成 `champion_overview.png` 总览图。单个玩家的详细截图在生成总览图后会被清理。
*   **模式 6-8 (C\_Arena系列 - 冠军竞技场)**:
    *   这些模式专注于冠军竞技场的不同阶段，自动化截图和信息记录流程。
    *   **核心流程**:
        *   **导航与点击**: 根据所选模式（完整分组、单组、冠军赛），脚本会自动点击相应的分组或比赛入口。
        *   **颜色判断**: 在特定比赛阶段（如4进2、2进1），通过比较屏幕上特定点的颜色来辅助决策点击目标。
        *   **信息与队伍截图**: 进入对战双方详情后，会依次截取玩家的详细信息面板和其所有防守队伍的配置图。
        *   **图像拼接**: 将单个玩家的多张信息截图和队伍截图垂直拼接成一张长图；然后将对战双方的玩家长图与该场比赛的结果截图水平拼接成一张总览图。
        *   **文件输出**: 所有生成的拼接图都保存在 `final_output/` 目录，并根据模式、分组和比赛阶段进行命名（例如 `group1_8in4_1.png`）。
    *   **模式 6 (晋级赛赛果 - 共8组)**：适用于冠军竞技场的分组赛阶段，脚本会从第1组到第8组，依次自动点击进入每个小组，然后对小组内的所有比赛（8进4、4进2、2进1）执行上述核心流程。
    *   **模式 7 (晋级赛当前小组赛果)**：适用于冠军竞技场的分组赛阶段，但只针对玩家当前在游戏中手动选定并显示的小组。脚本会对该小组内的所有比赛执行核心流程。
    *   **模式 8 (冠军赛赛果)**：适用于冠军竞技场的最终锦标赛阶段（通常是显示对阵图的界面）。脚本会对当前界面显示的比赛执行核心流程。
*   **模式 9 (图片标准化和打包)**:
    *   **操作对象**: `final_output/` 目录下的所有 `.png` 图片。
    *   **输出**:
        *   在 `output_webp/` 目录下生成处理后的 `.webp` 图片。
        *   在项目根目录下生成 `output_archive.zip` 压缩包，包含所有 `.webp` 图片。

## 📂 输出目录结构

*   `assets/`: (必需) 存放模式说明图片 [`1.png`](assets/1.png) 至 [`9.png`](assets/9.png)。
*   `temp_combined/`: 存放脚本运行过程中产生的临时截图文件，脚本正常结束后会自动清理此目录。
*   `final_output/`: 存放模式1-8生成的最终PNG格式拼接图。
*   `output_webp/`: 存放模式9生成的WebP格式图片。
*   `output_archive.zip`: (位于项目根目录) 模式9生成的包含所有WebP图片的压缩包。

## ⚠️ 注意事项

*   **管理员权限**: **强烈建议**以管理员权限运行脚本的GUI文件 ([`gui_app.py`](gui_app.py:1))。GUI会显示权限状态。
*   **游戏窗口**: 脚本运行时，请确保《NIKKE: 胜利女神》游戏窗口处于激活状态且未被遮挡。在5秒倒计时结束前，请将游戏窗口置于前台。
*   **坐标系统**: 脚本内的坐标是基于3840x2160分辨率计算的相对值。理论上应能适应不同分辨率，但如果遇到点击或截图位置不准的问题，可能需要检查游戏窗口的缩放设置或实际分辨率。
*   **界面语言与更新**: 脚本的点击和截图逻辑可能依赖于游戏界面的特定布局。如果游戏界面语言或版本更新导致布局变化，脚本可能需要调整。
*   **运行环境**: 请勿在脚本运行时随意移动或改变游戏窗口大小，这可能导致坐标计算错误。
*   **热键冲突**: 脚本使用 `Ctrl + 1` 作为全局停止热键。如果此热键与你的其他应用程序冲突，你可能需要在代码中修改它 (通常在GUI脚本的事件处理部分)。

## 🐛 故障排除

*   **脚本无反应或报错**:
    1.  检查是否以管理员权限运行（GUI会提示）。
    2.  检查所有Python依赖库是否已正确安装。
    3.  检查游戏是否已启动且窗口标题为 "NIKKE"。
    4.  查看GUI中的日志输出获取错误信息。
    5.  确保 `assets` 文件夹及其内容 ([`1.png`](assets/1.png) - [`9.png`](assets/9.png)) 存在于项目根目录。
*   **点击位置不准确**:
    1.  确认游戏窗口未被缩放，或尝试在游戏内使用常见分辨率。
    2.  脚本基于特定的UI元素位置进行点击，游戏更新可能导致这些位置变化，届时可能需要更新脚本中的坐标数据。

## 🤝 贡献

欢迎通过提交 Issue 或 Pull Request 来为本项目做出贡献。

## 📄 许可证

本项目采用 [MIT License](LICENSE)。
